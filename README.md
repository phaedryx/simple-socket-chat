Code based on this gist: https://gist.github.com/940468

thin start
